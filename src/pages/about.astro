---
import Layout from '../layouts/Layout.astro';
import PageHeader from '../components/PageHeader.astro';

// Prerender this page at build time (static HTML)
export const prerender = true;
---

<Layout title="About - Shakuhachi.ro" currentPage="browse">
  <PageHeader slot="header-metadata" title="About" />

  <div class="about-page">
    <section class="about-section">
      <h2>What is Shakuhachi.ro?</h2>
      <p>
        Shakuhachi.ro is a website for discovering, sharing, and creating shakuhachi scores.
        Whether you're learning a new piece or sharing your favorites with other players, this
        websitr makes it easy to work with shakuhachi notation online.
      </p>
      <p>
        This project is inspired by <a href="https://thesession.org/">The Sessions</a>, a community website dedicated to Irish traditional music, and Flat.io, a website to compose, collaborate, and publish western notation sheet music online.
</p>
    </section>

    <section class="about-section">
      <h2>How to Use</h2>
 
      <div class="feature">
        <h3>Fork a Score</h3>
        <p>
          <strong>What is forking?</strong> Forking creates your own editable copy of a score.
          This is useful when you want to make personal modificationsâ€”like adding your own
          fingering notes, changing the notation, or adapting the piece for your skill level.
        </p>
        <p>
          Your forked copy is completely independent. Changes you make won't affect the original
          score, and you can edit it freely.
        </p>
        <p>
          To fork a score: view any score and click the "Fork" button. You'll get your own copy
          that you can edit and share.
        </p>
      </div>

    </section>

    <section class="about-section">
      <h2>Notation Formats</h2>
      <p>
        The platform supports multiple notation input formats including MusicXML, JSON score data,
        and ABC notation. This flexibility allows you to work with scores from different
        sources or transcription tools.
      </p>
    </section>

    <section class="about-section">
      <h2>Open Source</h2>
      <p>
        Shakuhachi.ro is an open-source project. The code is available on
        <a
          href="https://github.com/chrisrauh/shakuhachi-ro"
          target="_blank"
          rel="noopener noreferrer">GitHub</a
        >.
      </p>
      <p>
        The shakuhachi notation renderer is also available as a standalone library that developers
        can use in their own projects.
      </p>
    </section>

    <section class="about-section">
      <h2>Contact</h2>
      <p>
        Questions, feedback, or issues? Reach out via
        <a
          href="https://github.com/chrisrauh/shakuhachi-ro/issues"
          target="_blank"
          rel="noopener noreferrer">GitHub Issues</a
        >
        or email
        <a href="mailto:hello@shakuhachi.ro">hello@shakuhachi.ro</a>.
      </p>
    </section>
  </div>

  <script>
    import { createElement, Book, Plus, Info, SunMoon } from 'lucide';
    import { ThemeSwitcher } from '../components/ThemeSwitcher';
    import { AuthWidget } from '../components/AuthComponents';
    import { authState } from '../api/authState';
    import { MobileMenu } from '../components/MobileMenu';
    import { createEmptyScore } from '../utils/create-score-handler';

    // Initialize theme switcher
    new ThemeSwitcher('theme-switcher');

    // Initialize auth widget
    const authWidget = new AuthWidget('auth-widget');

    // Subscribe to auth state changes
    authState.subscribe((user) => {
      if (user) {
        authWidget.setUser(user);
      } else {
        authWidget.setUser(null);
      }
    });

    // Helper to generate Lucide icon HTML
    const getIconHTML = (iconComponent: typeof Book) => {
      const icon = createElement(iconComponent);
      icon.setAttribute('width', '16');
      icon.setAttribute('height', '16');
      icon.setAttribute('stroke-width', '2');
      return icon.outerHTML;
    };

    // Initialize mobile menu
    const toggleTheme = () => {
      const html = document.documentElement;
      const currentTheme = html.getAttribute('data-theme');
      const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
      html.setAttribute('data-theme', newTheme);
    };

    const mobileMenu = new MobileMenu('mobile-menu');
    mobileMenu.setItems([
      {
        id: 'browse',
        label: 'Library',
        href: '/',
        icon: getIconHTML(Book),
        dividerAfter: false,
      },
      {
        id: 'create',
        label: 'Create score',
        action: async () => {
          const result = await createEmptyScore();
          if (result.error) {
            alert(result.error.message);
          } else {
            window.location.href = `/score/${result.slug}/edit`;
          }
        },
        icon: getIconHTML(Plus),
        dividerAfter: false,
      },
      {
        id: 'about',
        label: 'About',
        href: '/about',
        icon: getIconHTML(Info),
        dividerAfter: true,
      },
      {
        id: 'theme',
        label: 'Toggle theme',
        action: toggleTheme,
        icon: getIconHTML(SunMoon),
        dividerAfter: false,
      },
    ]);
  </script>

  <style>
    .about-page {
      max-width: 720px;
      margin: 0 auto;
      padding: 0 var(--spacing-medium);
    }

    .about-section {
      margin-bottom: var(--spacing-2x-large);
    }

    .about-section h2 {
      font-size: var(--font-size-x-large);
      font-weight: 500;
      margin-bottom: var(--spacing-medium);
      color: var(--color-text-heading);
    }

    .about-section h3 {
      font-size: var(--font-size-large);
      font-weight: 500;
      margin-bottom: var(--spacing-small);
      color: var(--color-text-heading);
    }

    .about-section p {
      font-size: var(--font-size-medium);
      line-height: 1.6;
      color: var(--color-text-secondary);
      margin-bottom: var(--spacing-medium);
    }

    .about-section p:last-child {
      margin-bottom: 0;
    }

    .feature {
      margin-bottom: var(--spacing-large);
    }

    .feature:last-child {
      margin-bottom: 0;
    }

    .about-section a {
      color: var(--color-link);
      text-decoration: none;
      border-bottom: 1px solid var(--color-link-border);
      transition: border-color var(--transition-fast);
    }

    .about-section a:hover {
      border-bottom-color: var(--color-link-border-hover);
    }

    @media (max-width: 768px) {
      .about-page {
        padding: 0 var(--spacing-small);
      }

      .about-section h2 {
        font-size: var(--font-size-large);
      }

      .about-section h3 {
        font-size: var(--font-size-medium);
      }

      .about-section p {
        font-size: var(--font-size-small);
      }
    }
  </style>
</Layout>
