---
import Layout from '../layouts/Layout.astro';

// Prerender this page at build time (static HTML)
export const prerender = true;
---

<Layout title="Shakuhachi Score Library" currentPage="browse">
  <!-- App name in header -->
  <div slot="header-metadata" class="score-header-metadata">
    <h1 class="score-title">Shakuhachi.ro</h1>
  </div>

  <div id="score-library"></div>

  <script>
    import { ThemeSwitcher } from '../components/ThemeSwitcher';
    import { AuthWidget } from '../components/AuthComponents';
    import { authState } from '../api/authState';
    import { ScoreLibrary } from '../components/ScoreLibrary';

    // Initialize theme switcher
    new ThemeSwitcher('theme-switcher');

    // Initialize auth widget
    const authWidget = new AuthWidget('auth-widget');

    // Subscribe to auth state changes
    authState.subscribe((user) => {
      if (user) {
        authWidget.setUser(user);
      } else {
        authWidget.setUser(null);
      }
    });

    // Initialize score library
    new ScoreLibrary('score-library');
  </script>

  <style>
    /* Header metadata styling - matches score page styling */
    :global(.score-header-metadata) {
      display: flex;
      align-items: center;
      gap: var(--spacing-small);
      font-size: var(--font-size-small);
      color: var(--color-neutral-600);
      flex-wrap: wrap;
    }

    :global(.score-title) {
      font-size: var(--font-size-large);
      font-weight: var(--font-weight-semibold);
      color: var(--color-neutral-900);
      margin: 0;
      text-box-trim: trim-both; /* Trims space above/below actual glyphs */
      text-box-edge: cap alphabetic; /* Uses cap-height and baseline */
    }
  </style>
</Layout>
